<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Log Analyzer Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; color: #111; }
    h1 { margin-bottom: 0; }
    .sub { color: #666; margin-top: 4px; margin-bottom: 20px; }
    .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; margin-bottom: 24px; }
    .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; box-shadow: 0 1px 2px rgba(0,0,0,.04); }
    canvas { max-width: 100%; height: 380px; }
    ul { padding-left: 18px; }
    .muted { color:#666; }
    table { width:100%; border-collapse: collapse; }
    th, td { border-bottom:1px solid #eee; padding:8px 6px; text-align:left; font-size:14px; }
    th { background:#fafafa; }
    code { background:#f6f8fa; padding:2px 6px; border-radius:6px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Log Analyzer Report</h1>
  <div class="sub">Generated at: 2025-08-29 19:34:02</div>

  <div class="cards">
    <div class="card">
      <h3>Top IPs (by requests)</h3>
      <canvas id="topIpsChart"></canvas>
    </div>
    <div class="card">
      <h3>Status Codes (distribution)</h3>
      <canvas id="statusChart"></canvas>
    </div>
  </div>

  <div class="card" style="margin-bottom:24px;">
    <h3>Timeline (requests per minute by status)</h3>
    <canvas id="timelineChart"></canvas>
    <div class="muted">Each line is a status code series.</div>
  </div>

  <div class="cards">
    <div class="card">
      <h3>Brute-force suspects</h3>
      
      <ul><li><code>203.0.113.5</code></li><li><code>192.168.1.11</code></li><li><code>198.51.100.42</code></li><li><code>10.0.0.25</code></li><li><code>192.168.1.10</code></li><li><code>185.199.110.153</code></li><li><code>104.21.77.12</code></li></ul>
      
    </div>
    <div class="card">
      <h3>Scanner suspects</h3>
      
      <ul><li><code>185.199.110.153</code></li><li><code>104.21.77.12</code></li></ul>
      
    </div>
    <div class="card">
      <h3>High-rate suspects</h3>
      
      <ul><li><code>104.21.77.12</code></li><li><code>185.199.110.153</code></li></ul>
      
    </div>
  </div>

  <div class="card">
    <h3>Suspicious Hits (sample)</h3>
    
    <table>
      <thead><tr><th>IP</th><th>Reason</th><th>Path</th></tr></thead>
      <tbody>
        
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>RCE pattern</td>
              <td><code>/cmd?exec=ls</code></td>
            </tr>
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/cmd?exec=ls</code></td>
            </tr>
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>Sensitive path probing</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>LFI/RFI pattern</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>Sensitive path probing</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>45.33.32.156</code></td>
              <td>Sensitive path probing</td>
              <td><code>/index.php?page=../../../../etc/passwd</code></td>
            </tr>
          
        
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>Sensitive path probing</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>Sensitive path probing</td>
              <td><code>/wp-login.php</code></td>
            </tr>
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/wp-login.php</code></td>
            </tr>
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>Sensitive path probing</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>RCE pattern</td>
              <td><code>/cmd?exec=ls</code></td>
            </tr>
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/cmd?exec=ls</code></td>
            </tr>
          
            <tr>
              <td><code>66.249.66.1</code></td>
              <td>Sensitive path probing</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
        
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>Sensitive path probing</td>
              <td><code>/login.php?id=1&#39;--</code></td>
            </tr>
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>SQLi pattern</td>
              <td><code>/login.php?id=1&#39;--</code></td>
            </tr>
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/login.php?id=1&#39;--</code></td>
            </tr>
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>Sensitive path probing</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>LFI/RFI pattern</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>Sensitive path probing</td>
              <td><code>/phpmyadmin</code></td>
            </tr>
          
            <tr>
              <td><code>103.21.244.0</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/phpmyadmin</code></td>
            </tr>
          
        
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>Sensitive path probing</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>LFI/RFI pattern</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/etc/passwd</code></td>
            </tr>
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>Sensitive path probing</td>
              <td><code>/wp-admin</code></td>
            </tr>
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/search.php?q=union+select+1,2,3</code></td>
            </tr>
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/search.php?q=union+select+1,2,3</code></td>
            </tr>
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>Sensitive path probing</td>
              <td><code>/wp-admin</code></td>
            </tr>
          
            <tr>
              <td><code>5.188.10.20</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/wp-admin</code></td>
            </tr>
          
        
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>Sensitive path probing</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>Sensitive path probing</td>
              <td><code>/login.php?id=1&#39;--</code></td>
            </tr>
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>SQLi pattern</td>
              <td><code>/login.php?id=1&#39;--</code></td>
            </tr>
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/login.php?id=1&#39;--</code></td>
            </tr>
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/</code></td>
            </tr>
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>Sensitive path probing</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>185.199.110.153</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/.git/config</code></td>
            </tr>
          
        
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/scripts/app.js</code></td>
            </tr>
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/index.html</code></td>
            </tr>
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/images/logo.png</code></td>
            </tr>
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Sensitive path probing</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/.git/config</code></td>
            </tr>
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/products</code></td>
            </tr>
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/scripts/app.js</code></td>
            </tr>
          
            <tr>
              <td><code>104.21.77.12</code></td>
              <td>Suspicious/empty User-Agent</td>
              <td><code>/</code></td>
            </tr>
          
        
      </tbody>
    </table>
    <div class="muted" style="margin-top:8px;">Showing up to 8 rows per IP.</div>
    
  </div>

  <script>
    /* These are injected by Jinja (pre-serialized JSON from Python) */
    const topIpsLabels = ["185.199.110.153", "104.21.77.12", "192.168.1.10", "203.0.113.5", "198.51.100.42", "10.0.0.25", "192.168.1.11", "45.33.32.156", "66.249.66.1", "103.21.244.0"];
    const topIpsValues = [1500, 1500, 73, 72, 71, 66, 64, 17, 17, 11];
    const statusLabels = ["200", "403", "404", "500"];
    const statusValues = [1992, 266, 1069, 73];
    const timelineLabels = ["2024-10-10 13:55", "2024-10-10 13:56", "2024-10-10 13:57", "2024-10-10 13:58", "2024-10-10 13:59", "2024-10-10 14:00", "2024-10-10 14:01", "2024-10-10 14:02"];
    const timelineSeries = {"200": [9, 25, 749, 208, 29, 936, 30, 6], "403": [8, 12, 92, 34, 10, 98, 8, 4], "404": [1, 13, 407, 111, 12, 511, 12, 2], "500": [6, 10, 12, 7, 9, 15, 10, 4]};

    function colorAt(i){
      const colors = [
        'rgba(99, 102, 241, 0.8)',
        'rgba(16, 185, 129, 0.8)',
        'rgba(244, 63, 94, 0.8)',
        'rgba(234, 179, 8, 0.8)',
        'rgba(59, 130, 246, 0.8)',
        'rgba(139, 92, 246, 0.8)',
        'rgba(20, 184, 166, 0.8)',
      ];
      return colors[i % colors.length];
    }

    // Top IPs (bar)
    new Chart(document.getElementById('topIpsChart'), {
      type: 'bar',
      data: {
        labels: topIpsLabels,
        datasets: [{ label: 'Requests', data: topIpsValues, backgroundColor: topIpsLabels.map((_,i)=>colorAt(i)) }]
      },
      options: {
        plugins: { legend: { display: false }},
        scales: { x: { ticks: { autoSkip: false }}, y: { beginAtZero: true } }
      }
    });

    // Status Codes (doughnut)
    new Chart(document.getElementById('statusChart'), {
      type: 'doughnut',
      data: {
        labels: statusLabels,
        datasets: [{ data: statusValues, backgroundColor: statusLabels.map((_,i)=>colorAt(i)) }]
      },
      options: {
        plugins: { legend: { position: 'bottom' }}
      }
    });

    // Timeline (line)
    const datasets = Object.keys(timelineSeries).map((status, i) => ({
      label: status,
      data: timelineSeries[status],
      borderColor: colorAt(i),
      backgroundColor: colorAt(i),
      fill: false,
      tension: 0.2,
      pointRadius: 0
    }));

    new Chart(document.getElementById('timelineChart'), {
      type: 'line',
      data: { labels: timelineLabels, datasets },
      options: {
        scales: { y: { beginAtZero: true }, x: { ticks: { maxRotation: 0, autoSkip: true } } },
        plugins: { legend: { position: 'bottom' } }
      }
    });
  </script>
</body>
</html>